name: Notify Discord on Release

on:
  release:
    types: [published]

jobs:
  notify-discord:
    runs-on: ubuntu-latest

    steps:
    - name: Send Discord Notification
      env:
        DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        RELEASE_TAG: ${{ github.event.release.tag_name }}
        RELEASE_NAME: ${{ github.event.release.name }}
        RELEASE_URL: ${{ github.event.release.html_url }}
        REPO_NAME: ${{ github.repository }}
      run: |
        curl -X POST -H "Content-Type: application/json" \
          -d '{
                "username": "GitHub Actions",
                "avatar_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",
                "content": "New release in **$REPO_NAME**!\n\n**$RELEASE_NAME**\nTag: $RELEASE_TAG\n[View Release]($RELEASE_URL)"
              }' \
          $DISCORD_WEBHOOK_URL
